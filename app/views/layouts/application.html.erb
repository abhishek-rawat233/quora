<!DOCTYPE html>
<html>
  <head>
    <title>Quora</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-light primary-color" style="background-color: red;">
      <a class="navbar-brand" href= "<%= root_path %>" ><strong>Quora</strong></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
     <span class="navbar-toggler-icon"></span>
    </button>
    <div class="navbar" id="collapse navbar-collapse">
      <ul class="navbar-nav">
        <li class="nav-item active">
          <a class="nav-link" href= "<%= home_path %>" >Home <span class="sr-only">(current)</span></a>
        </li>
      </ul>


      <% if @current_user %>
      <ul class="navbar-nav ml-auto nav-flex-icons">
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink-555" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">Notifications
          <% notifications_present = !@unseen_notifications.length.zero? %>
        <span id = "notifications-counter" data-user-id="<%= @current_user.id %>" ><%= @unseen_notifications.length if notifications_present %></span></a>
        <div class="dropdown-menu dropdown-secondary" aria-labelledby="navbarDropdownMenuLink-555">
          <%= link_to 'mark all as seen', mark_all_as_seen_user_path(@current_user), method: :patch, remote: true, id: "status_changing_link", style: "#{'display: none' unless notifications_present}" %>
          <div id="notifications-container">
            <%= 'No Notifications' unless notifications_present %>
            <% @unseen_notifications.each do |notification| %>
            <% question = notification.question %>
            <%= link_to question.title, user_question_path(@current_user, question), class: "dropdown-item" %>
            <% end %>
          </div>
        </div>
      </li>
      <li class="nav-item avatar dropdown">
        <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink-55" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          <%= image_tag(@profile_image, size:30, class: "rounded-circle z-depth-0" ) if @current_user.present? %>
          </a>
        <div class="dropdown-menu dropdown-menu-lg-right dropdown-secondary"
          aria-labelledby="navbarDropdownMenuLink-55">
            <%= link_to 'profile', user_path(@current_user), class: "dropdown-item" %>
            <%= link_to 'Logout', logout_path, class: "dropdown-item", method: :delete %>
          <% end %>
        </div>
      </li>
      </div>
    </nav>
    <div>
    <% if notice %>
      <aside id="notice"><%= notice %></aside>
    <% end %>

    <%= yield %>
    </div>
  </body>
</html>
